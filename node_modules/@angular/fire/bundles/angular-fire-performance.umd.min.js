!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/fire"),require("@angular/common")):"function"==typeof define&&define.amd?define("@angular/fire/performance",["exports","@angular/core","rxjs","rxjs/operators","@angular/fire","@angular/common"],n):n(((e=e||self).angular=e.angular||{},e.angular.fire=e.angular.fire||{},e.angular.fire.performance={}),e.ng.core,e.rxjs,e.rxjs.operators,e.angular.fire,e.ng.common)}(this,(function(e,n,r,t,i,o){"use strict";var a=new n.InjectionToken("angularfire2.performance.auto_trace"),u=new n.InjectionToken("angularfire2.performance.instrumentationEnabled"),c=new n.InjectionToken("angularfire2.performance.dataCollectionEnabled"),s=function(e,n,a,u,c){return this.zone=u,this.performance=r.of(void 0).pipe(t.switchMap((function(){return o.isPlatformBrowser(c)?u.runOutsideAngular((function(){return import("firebase/performance")})):r.EMPTY})),t.map((function(){return u.runOutsideAngular((function(){return e.performance()}))})),t.tap((function(e){!0!==n&&(e.instrumentationEnabled=!1),!0!==a&&(e.dataCollectionEnabled=!1)})),t.shareReplay({bufferSize:1,refCount:!1})),i.ɵlazySDKProxy(this,this.performance,u)};s.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],s.ctorParameters=function(){return[{type:i.FirebaseApp},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[u]}]},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[c]}]},{type:n.NgZone},{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},s.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new s(n.ɵɵinject(i.FirebaseApp),n.ɵɵinject(u,8),n.ɵɵinject(c,8),n.ɵɵinject(n.NgZone),n.ɵɵinject(n.PLATFORM_ID))},token:s,providedIn:"any"});var f=function(e){if("undefined"!=typeof window&&window.performance){var n=window.performance.getEntriesByName(e,"measure")||[],t="_"+e+"Start["+n.length+"]",i="_"+e+"End["+n.length+"]";return new r.Observable((function(n){return window.performance.mark(t),n.next(),{unsubscribe:function(){window.performance.mark(i),window.performance.measure(e,t,i)}}}))}return r.EMPTY};var p=!("undefined"==typeof window||!window.performance||(window.performance.mark("_isStableStart"),0)),b=function(){function e(e){p&&(this.disposable=e.isStable.pipe(t.first((function(e){return e})),t.tap((function(){window.performance.mark("_isStableEnd"),window.performance.measure("isStable","_isStableStart","_isStableEnd")}))).subscribe())}return e.prototype.ngOnDestroy=function(){this.disposable&&this.disposable.unsubscribe()},e}();b.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],b.ctorParameters=function(){return[{type:n.ApplicationRef}]},b.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new b(n.ɵɵinject(n.ApplicationRef))},token:b,providedIn:"any"});var l=function(e,n){e.dataCollectionEnabled};l.decorators=[{type:n.NgModule,args:[{providers:[s]}]}],l.ctorParameters=function(){return[{type:s},{type:b,decorators:[{type:n.Optional}]}]},e.AUTOMATICALLY_TRACE_CORE_NG_METRICS=a,e.AngularFirePerformance=s,e.AngularFirePerformanceModule=l,e.DATA_COLLECTION_ENABLED=c,e.INSTRUMENTATION_ENABLED=u,e.PerformanceMonitoringService=b,e.trace=function(e){return function(n){return new r.Observable((function(r){var i=f(e).subscribe();return n.pipe(t.tap((function(){return i.unsubscribe()}),(function(){}),(function(){return i.unsubscribe()}))).subscribe(r)}))}},e.traceUntil=function(e,n,i){return function(o){return new r.Observable((function(r){var a=f(e).subscribe();return o.pipe(t.tap((function(e){return n(e)&&a.unsubscribe()}),(function(){}),(function(){return i&&i.orComplete&&a.unsubscribe()}))).subscribe(r)}))}},e.traceUntilComplete=function(e){return function(n){return new r.Observable((function(r){var i=f(e).subscribe();return n.pipe(t.tap((function(){}),(function(){}),(function(){return i.unsubscribe()}))).subscribe(r)}))}},e.traceUntilFirst=function(e){return function(n){return new r.Observable((function(r){var i=f(e).subscribe();return n.pipe(t.tap((function(){return i.unsubscribe()}),(function(){}),(function(){}))).subscribe(r)}))}},e.traceWhile=function(e,n,i){return function(o){return new r.Observable((function(r){var a;return o.pipe(t.tap((function(r){n(r)?a=a||f(e).subscribe():(a&&a.unsubscribe(),a=void 0)}),(function(){}),(function(){return i&&i.orComplete&&a&&a.unsubscribe()}))).subscribe(r)}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-fire-performance.umd.min.js.map